{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Introduction Poi is a Python Package for writing data to xlsx files. It allows you to declaratively specify the Shape of your data, and Poi will manage how to write it to the corresponding Cell for you automatically. Poi is on top of the xlsxwriter library. System requirements Poi requires Python 3.7+. Installation pip install poi Philosophy Manually writing excel file using library like xlsxwriter has long been a pain point for application developers, you have to specify what to write in each cell and row , how to merge cells , the style of each cell, .etc. Leading to code like this: # Iterate over the data and write it out row by row. for item , cost in ( expenses ): worksheet . write ( row , col , item ) worksheet . write ( row , col + 1 , cost ) row += 1 # Write a total using a formula. worksheet . write ( row , 0 , 'Total' ) worksheet . write ( row , 1 , '=SUM(B1:B4)' ) merge_format = workbook . add_format ({ 'bold' : True , 'border' : 6 , 'align' : 'center' , 'valign' : 'vcenter' , 'fg_color' : '#D7E4BC' , }) worksheet . merge_range ( 2 , 1 , 3 , 3 , 'Merged Cells' , merge_format ) I think its too low level for application developers who just want to export some data to excel file. And maintaining imperative code like this is error prone and so hard that we may want a better way to deal with exporting data to excel. Why not just write a Schema of what we want to export and there's some tool to turn it to a valid xlsx file? Hopefully, this is just what Poi does. Quick Start A Hello World example. What wee need is just a Sheet object. from poi import Sheet , Cell sheet = Sheet ( root = Cell ( \"hello world\" ) ) sheet . write ( 'hello.xlsx' ) Then an xlsx file has been created. What happened? We've created a Sheet object with a single Cell Node, which just contains the text hello world , and then we call sheet.write to write the sheet object to the hello.xlsx file. See, that's pretty simple. Of course Poi's ability is far beyond this, jump to Basic Usage for more examples.","title":"Introduction"},{"location":"#introduction","text":"Poi is a Python Package for writing data to xlsx files. It allows you to declaratively specify the Shape of your data, and Poi will manage how to write it to the corresponding Cell for you automatically. Poi is on top of the xlsxwriter library.","title":"Introduction"},{"location":"#system-requirements","text":"Poi requires Python 3.7+.","title":"System requirements"},{"location":"#installation","text":"pip install poi","title":"Installation"},{"location":"#philosophy","text":"Manually writing excel file using library like xlsxwriter has long been a pain point for application developers, you have to specify what to write in each cell and row , how to merge cells , the style of each cell, .etc. Leading to code like this: # Iterate over the data and write it out row by row. for item , cost in ( expenses ): worksheet . write ( row , col , item ) worksheet . write ( row , col + 1 , cost ) row += 1 # Write a total using a formula. worksheet . write ( row , 0 , 'Total' ) worksheet . write ( row , 1 , '=SUM(B1:B4)' ) merge_format = workbook . add_format ({ 'bold' : True , 'border' : 6 , 'align' : 'center' , 'valign' : 'vcenter' , 'fg_color' : '#D7E4BC' , }) worksheet . merge_range ( 2 , 1 , 3 , 3 , 'Merged Cells' , merge_format ) I think its too low level for application developers who just want to export some data to excel file. And maintaining imperative code like this is error prone and so hard that we may want a better way to deal with exporting data to excel. Why not just write a Schema of what we want to export and there's some tool to turn it to a valid xlsx file? Hopefully, this is just what Poi does.","title":"Philosophy"},{"location":"#quick-start","text":"A Hello World example. What wee need is just a Sheet object. from poi import Sheet , Cell sheet = Sheet ( root = Cell ( \"hello world\" ) ) sheet . write ( 'hello.xlsx' ) Then an xlsx file has been created. What happened? We've created a Sheet object with a single Cell Node, which just contains the text hello world , and then we call sheet.write to write the sheet object to the hello.xlsx file. See, that's pretty simple. Of course Poi's ability is far beyond this, jump to Basic Usage for more examples.","title":"Quick Start"},{"location":"advanced/","text":"","title":"Advanced"},{"location":"basic-usage/","text":"A Basic Example Write title , a paragraph and a signature row . from poi import Sheet , Row , Cell sheet = Sheet ( root = [ Row ( children = [ Cell ( \"title\" , grow = True , align = \"center\" , ) ] ), Row ( children = [ Cell ( \"this is your awesome content\" , grow = True , border = 1 , valign = \"vcenter\" , rowspan = 4 , height = 100 , ) ] ), Row ( colspan = 8 , children = [ Cell ( \"signature:\" , offset = 5 , grow = True , bg_color = 'yellow' ), Cell ( \"\" ) ], ) ], ) sheet . write ( 'out.xlsx' ) Export A Data Table from typing import NamedTuple from datetime import datetime import random from poi import Sheet , Table class Product ( NamedTuple ): name : str desc : str price : int created_at : datetime img : str data = [ Product ( name = f \"prod { i } \" , desc = f \"desc { i } \" , price = random . randint ( 1 , 100 ), created_at = datetime . now (), img = \"./docs/assets/product.jpg\" , ) for i in range ( 5 ) ] columns = [ { \"type\" : \"image\" , \"attr\" : \"img\" , \"title\" : \"Product Image\" , \"options\" : { \"x_scale\" : 0.27 , \"y_scale\" : 0.25 }, }, ( \"name\" , \"Name\" ), ( \"desc\" , \"Description\" ), ( \"price\" , \"Price\" ), ( \"created_at\" , \"Create Time\" ), ] sheet = Sheet ( root = Table ( data = data , columns = columns , row_height = 80 , cell_style = { \"color: red\" : lambda record , col : col . attr == \"price\" and record . price > 50 }, date_format = \"yyyy-mm-dd\" , align = \"center\" , border = 1 , ) ) sheet . write ( \"table.xlsx\" ) Use with your favorite Web Framework You can integrate Poi with any web framework easily. Flask from flask import send_file def export ( sheet , filename ): return send_file ( sheet . to_bytes_io (), attachment_filename = filename , mimetype = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" , ) Django from django.http import HttpResponse def export ( sheet , filename ): response = HttpResponse ( sheet . to_bytes_io () . read (), content_type = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" , ) response [ \"Content-Disposition\" ] = f \"attachment; filename= { filename } \" return response","title":"Basic Usage"},{"location":"basic-usage/#a-basic-example","text":"Write title , a paragraph and a signature row . from poi import Sheet , Row , Cell sheet = Sheet ( root = [ Row ( children = [ Cell ( \"title\" , grow = True , align = \"center\" , ) ] ), Row ( children = [ Cell ( \"this is your awesome content\" , grow = True , border = 1 , valign = \"vcenter\" , rowspan = 4 , height = 100 , ) ] ), Row ( colspan = 8 , children = [ Cell ( \"signature:\" , offset = 5 , grow = True , bg_color = 'yellow' ), Cell ( \"\" ) ], ) ], ) sheet . write ( 'out.xlsx' )","title":"A Basic Example"},{"location":"basic-usage/#export-a-data-table","text":"from typing import NamedTuple from datetime import datetime import random from poi import Sheet , Table class Product ( NamedTuple ): name : str desc : str price : int created_at : datetime img : str data = [ Product ( name = f \"prod { i } \" , desc = f \"desc { i } \" , price = random . randint ( 1 , 100 ), created_at = datetime . now (), img = \"./docs/assets/product.jpg\" , ) for i in range ( 5 ) ] columns = [ { \"type\" : \"image\" , \"attr\" : \"img\" , \"title\" : \"Product Image\" , \"options\" : { \"x_scale\" : 0.27 , \"y_scale\" : 0.25 }, }, ( \"name\" , \"Name\" ), ( \"desc\" , \"Description\" ), ( \"price\" , \"Price\" ), ( \"created_at\" , \"Create Time\" ), ] sheet = Sheet ( root = Table ( data = data , columns = columns , row_height = 80 , cell_style = { \"color: red\" : lambda record , col : col . attr == \"price\" and record . price > 50 }, date_format = \"yyyy-mm-dd\" , align = \"center\" , border = 1 , ) ) sheet . write ( \"table.xlsx\" )","title":"Export A Data Table"},{"location":"basic-usage/#use-with-your-favorite-web-framework","text":"You can integrate Poi with any web framework easily.","title":"Use with your favorite Web Framework"},{"location":"basic-usage/#flask","text":"from flask import send_file def export ( sheet , filename ): return send_file ( sheet . to_bytes_io (), attachment_filename = filename , mimetype = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" , )","title":"Flask"},{"location":"basic-usage/#django","text":"from django.http import HttpResponse def export ( sheet , filename ): response = HttpResponse ( sheet . to_bytes_io () . read (), content_type = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" , ) response [ \"Content-Disposition\" ] = f \"attachment; filename= { filename } \" return response","title":"Django"}]}